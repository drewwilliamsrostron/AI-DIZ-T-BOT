import torch

try:
    if torch.cuda.is_available():
        device = "cuda"
    elif getattr(torch.backends, "mps", None) and torch.backends.mps.is_available():
        device = "mps"
    else:
        device = "cpu"
except Exception:  # pragma: no cover - mocked torch
    device = "cpu"
